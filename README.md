# @luxfi/common

[![NPM version](https://img.shields.io/npm/v/@debank/common.svg)](https://www.npmjs.org/package/@debank/common)
[![Build Status][actions-image]][actions-url]

[actions-image]: https://github.com/DeBankDeFi/fe-common/actions/workflows/test.yml/badge.svg
[actions-url]: https://github.com/DeBankDeFi/fe-common/actions/workflows/test.yml

common library for luxfi frontend projects, including information about the **chains supported in the business**. Different businesses may support different chains. Please introduce different entries according to the business.

## Install

```bash
yarn add @luxfi/common
```

## Usage

```ts
import { CHAINS_LIST, CHAINS, CHAINS_ENUM } from '@luxfi/common'
import { type Chain } from '@luxfi/common'
```

`CHAINS_LIST` is **order sensitive**. `CHAINS` is a map of chain information, and `CHAINS_ENUM` is an enumeration of chain information, their keys' order is **same** with the order in `CHAINS_LIST`.

## Entries

There are three entries in the library, which are used to describe the chain information supported by the business:

- default: `@luxfi/common`
- rabby: `@luxfi/common/dist/index-lux`
- mainsite: `@luxfi/common/dist/index-mainsite`

```ts
// full
import { CHAINS_LIST, CHAINS, CHAINS_ENUM } from '@luxfi/common'
// rabby
import { CHAINS_LIST, CHAINS, CHAINS_ENUM } from '@luxfi/common/dist/index-lux'
```

## How to import

We guarantee all entries export those object/types:

- `CHAINS_LIST`: type, runtime variable
- `CHAINS`: type, runtime variable
- `CHAINS_ENUM`: enum, runtime variable
- `Chain`: type

So if your webpack-based project used to import ALL chains before, but from one moment, you customize the chain list and add one new entry (like `'@luxfi/common/dist/index-lux'`), you can configure the `resolve.alias` to keep `@luxfi/common` in your project, just like:

```js
// webpack.config.js
module.exports = {
  // ...
  resolve: {
    alias: {
      '@luxfi/common': '@luxfi/common/dist/index-lux'
    }
  }
}
```

Why? `CHAINS_ENUM` exported from `'@luxfi/common'` is the real `enum` type in TypeScript, but the `CHAINS_ENUM` from `'@luxfi/common/dist/index-lux'` is a const object which generated by `enum` type. You can use `CHAINS_ENUM.ETH` from `'@luxfi/common'` as enum, but you **cannot** use `CHAINS_ENUM.ETH` from `'@luxfi/common/dist/index-lux'` as enum.

in [Rabby] project, we used to use `CHAINS_ENUM` as enum, but one day we need omit some chains at runtime, we don't want change all references of `CHAINS_ENUM` at [Rabby], so we configure the `resolve.alias` to keep `@luxfi/common` in [Rabby] project, but at runtime it's actually `@luxfi/common/dist/index-lux`.

If you never mind the enum type, e.g. you start a fresh project, you can use `@luxfi/common/dist/index-lux` directly.

```ts
// full
import { CHAINS_LIST, CHAINS, CHAINS_ENUM } from '@luxfi/common'
// rabby
import { CHAINS_LIST, CHAINS, CHAINS_ENUM } from '@luxfi/common/dist/index-lux'
```

[Rabby]:https://github.com/RabbyHub/Rabby

## Test

Test is often forgotten after it's written, but if you want to modified the `CHAINS_LIST`, before you publish it, the Test is forced to run to ensure the `CHAINS_LIST` works as you expected.

You may also want to know which chains are omitted in specific entry, you can run `yarn test:d` to see the details.

![test](./docs/see-omitted-chain.png)



